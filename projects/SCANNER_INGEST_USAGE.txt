Scanner Bullet Ingestion Script - Usage Guide
==============================================

BASIC USAGE:
-----------
python ingest_scanner_bullets.py <input_file.json>

OR from stdin:
cat input.json | python ingest_scanner_bullets.py


INPUT FORMAT:
------------
JSON file containing an array of scanner bullet objects with these fields:

Required:
  - date             (YYYY-MM-DD format recommended)
  - company          (Defense company name)
  - product          (Product/capability name)

Optional:
  - customer         (Customer or location)
  - region           (Geographic region)
  - threat/opportunity (Description)
  - source           (Source URL)
  - confidence       (H/M/L - High/Medium/Low)

Field name variations supported:
  - product/capability, capability → product
  - customer/location, location → customer
  - threat/opportunity, threat, opportunity → threat_opportunity
  - source link, source_link → source


OUTPUT:
------
Appends normalized rows to: 02_structured/knowledge_base.csv

De-duplication key: (date, company, product)
- If a row with the same date+company+product exists, it will be skipped


EXAMPLES:
--------
1. Basic ingestion:
   python ingest_scanner_bullets.py scanner_output.json

2. From stdin:
   echo '[{"date":"2025-01-15","company":"Acme","product":"Widget"}]' | python ingest_scanner_bullets.py

3. Check exit code:
   python ingest_scanner_bullets.py input.json
   echo $?  # 0 = success, 1 = errors occurred


SUMMARY OUTPUT:
--------------
The script prints a summary showing:
  - Rows added (new entries)
  - Rows skipped (duplicates)
  - Errors (validation failures)
  - Total processed

Exit code: 0 on success, 1 if any errors occurred


ERROR HANDLING:
--------------
The script validates:
  ✓ Required fields (date, company, product)
  ✓ Confidence level (must be H, M, L, or empty)
  ✓ JSON format validity
  ✓ File encoding (UTF-8)

Errors are reported to stderr with bullet numbers for easy debugging.
